<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Charity Poker Seating</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .highlight { border: 4px solid #eab308; transform: scale(1.02); z-index: 10; box-shadow: 0 0 20px rgba(234, 179, 8, 0.4); }
        .admin-only { display: none; } /* Hidden by default for players */
        body.admin-mode .admin-only { display: block; }
        body.admin-mode .player-view { display: none; }
    </style>
</head>
<body class="bg-slate-950 text-white p-4 font-sans min-h-screen flex flex-col">

    <div class="max-w-4xl mx-auto w-full flex-grow">
        
        <header class="flex justify-between items-center mb-8 p-4 bg-slate-900 rounded-xl border border-slate-800">
            <div>
                <h1 class="text-xl font-black text-red-600 uppercase italic">Poker Charity Event</h1>
                <p id="mode-label" class="text-slate-500 text-[10px] uppercase tracking-widest">Player Check-In Mode</p>
            </div>
            <button onclick="toggleAdmin()" class="opacity-0 w-10 h-10">Admin</button>
        </header>

        <div class="player-view text-center space-y-8 py-10">
            <h2 class="text-3xl font-bold">Find Your Table</h2>
            <div class="max-w-xs mx-auto">
                <label class="block text-slate-400 text-sm mb-2">Enter the number assigned to you:</label>
                <input type="number" id="playerSearch" placeholder="Ex: 42" 
                       class="w-full p-6 bg-slate-800 rounded-2xl border-4 border-red-600 text-4xl text-center font-black outline-none focus:ring-4 focus:ring-red-500/50">
                <button onclick="checkSeat()" class="w-full mt-4 bg-red-600 hover:bg-red-700 p-4 rounded-xl font-bold text-lg transition shadow-lg">FIND MY SEAT</button>
            </div>

            <div id="resultArea" class="hidden animate-bounce mt-10 p-8 bg-slate-900 border-2 border-yellow-500 rounded-3xl shadow-2xl">
                <span class="text-slate-400 uppercase text-sm tracking-tighter">Your Assignment:</span>
                <div id="tableResult" class="text-6xl font-black text-yellow-500 mt-2">TABLE 1</div>
            </div>
        </div>

        <div class="admin-only space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-slate-900 p-4 rounded-xl border border-slate-800">
                    <h3 class="text-red-500 font-bold mb-2">Master Shuffle</h3>
                    <div class="flex gap-2">
                        <input type="number" id="playerCount" value="64" class="w-1/2 p-2 bg-slate-800 rounded text-center">
                        <button onclick="fullShuffle()" class="w-1/2 bg-red-600 p-2 rounded font-bold text-xs">RESET ALL</button>
                    </div>
                </div>
                <div class="bg-slate-900 p-4 rounded-xl border border-slate-800 border-t-2 border-t-blue-500">
                    <h3 class="text-blue-500 font-bold mb-2">Add Late Player</h3>
                    <div class="flex gap-2">
                        <input type="number" id="latePlayerId" placeholder="ID #" class="w-1/2 p-2 bg-slate-800 rounded text-center">
                        <button onclick="addLatePlayer()" class="w-1/2 bg-blue-600 p-2 rounded font-bold text-xs">ADD SEAT</button>
                    </div>
                </div>
            </div>
            <div id="tableContainer" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
            <button onclick="toggleAdmin()" class="w-full p-2 text-slate-600 text-xs">Exit Admin Mode</button>
        </div>
    </div>

    <script>
        let tables = [];

        // ADMIN FUNCTIONS
        function toggleAdmin() {
            document.body.classList.toggle('admin-mode');
            const isAdmin = document.body.classList.contains('admin-mode');
            document.getElementById('mode-label').innerText = isAdmin ? "ADMIN CONTROL" : "Player Check-In Mode";
        }

        function fullShuffle() {
            const pCount = parseInt(document.getElementById('playerCount').value);
            const tSize = 8; // Defaulting to 8
            let players = Array.from({length: pCount}, (_, i) => i + 1);
            for (let i = players.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [players[i], players[j]] = [players[j], players[i]];
            }
            tables = [];
            for(let t = 0; t < Math.ceil(pCount / tSize); t++) {
                tables.push({ id: t + 1, players: players.slice(t * tSize, (t + 1) * tSize), max: tSize });
            }
            saveData();
            renderAdmin();
        }

        function addLatePlayer() {
            const id = parseInt(document.getElementById('latePlayerId').value);
            if(!id || tables.some(t => t.players.includes(id))) return;
            let target = tables.find(t => t.players.length < t.max);
            if(target) target.players.push(id);
            else tables.push({ id: tables.length + 1, players: [id], max: 8 });
            saveData();
            renderAdmin();
        }

        // PLAYER FUNCTIONS
        function checkSeat() {
            const searchVal = parseInt(document.getElementById('playerSearch').value);
            const resultArea = document.getElementById('resultArea');
            const tableResult = document.getElementById('tableResult');
            
            if(!searchVal) return;

            const foundTable = tables.find(t => t.players.includes(searchVal));
            
            resultArea.classList.remove('hidden');
            if(foundTable) {
                tableResult.innerText = `TABLE ${foundTable.id}`;
                tableResult.classList.remove('text-red-500');
                tableResult.classList.add('text-yellow-500');
            } else {
                tableResult.innerText = "NOT FOUND";
                tableResult.classList.remove('text-yellow-500');
                tableResult.classList.add('text-red-500');
            }
        }

        // DATA PERSISTENCE (Crucial for GitHub Pages refreshes)
        function saveData() {
            localStorage.setItem('poker_tables', JSON.stringify(tables));
        }

        function loadData() {
            const saved = localStorage.getItem('poker_tables');
            if(saved) {
                tables = JSON.parse(saved);
                renderAdmin();
            }
        }

        function renderAdmin() {
            const container = document.getElementById('tableContainer');
            container.innerHTML = '';
            tables.forEach(t => {
                const div = document.createElement('div');
                div.className = 'bg-slate-900 p-2 rounded border border-slate-800 text-[10px]';
                div.innerHTML = `<b class="text-red-500">T-${t.id}</b>: ${t.players.join(', ')}`;
                container.appendChild(div);
            });
        }

        loadData();
    </script>
</body>
</html>
